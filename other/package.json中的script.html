<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Package.json 配置 | VitePress</title>
    <meta name="description" content="Just playing around.">
    <link rel="preload stylesheet" href="/personal-website/assets/style.91ec3e89.css" as="style">
    <link rel="modulepreload" href="/personal-website/assets/app.7ff22c70.js">
    <link rel="modulepreload" href="/personal-website/assets/other_package.json中的script.md.385b2432.lean.js">
    
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-93a960b4><!--[--><!--]--><!--[--><span tabindex="-1" data-v-151f2593></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-151f2593> Skip to content </a><!--]--><!----><header class="VPNav" data-v-93a960b4 data-v-0fa0e57d><div class="VPNavBar has-sidebar" data-v-0fa0e57d data-v-be450ad9><div class="container" data-v-be450ad9><div class="title" data-v-be450ad9><div class="VPNavBarTitle has-sidebar" data-v-be450ad9 data-v-6d2fb2d9><a class="title" href="/personal-website/" data-v-6d2fb2d9><!--[--><!--]--><!----><!--[-->momoyu<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-be450ad9><div class="curtain" data-v-be450ad9></div><div class="content-body" data-v-be450ad9><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-be450ad9 data-v-bdedfc22><span id="main-nav-aria-label" class="visually-hidden" data-v-bdedfc22>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/personal-website/interview/" data-v-bdedfc22 data-v-95f5d58b data-v-30c06bd3><!--[-->面试<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/personal-website/algorithm/" data-v-bdedfc22 data-v-95f5d58b data-v-30c06bd3><!--[-->数据结构和算法<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/personal-website/javascript/" data-v-bdedfc22 data-v-95f5d58b data-v-30c06bd3><!--[-->JavaScript<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/personal-website/vue/" data-v-bdedfc22 data-v-95f5d58b data-v-30c06bd3><!--[-->Vue<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/personal-website/react/" data-v-bdedfc22 data-v-95f5d58b data-v-30c06bd3><!--[-->React<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/personal-website/sourcecode/" data-v-bdedfc22 data-v-95f5d58b data-v-30c06bd3><!--[-->源码<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/personal-website/daily/" data-v-bdedfc22 data-v-95f5d58b data-v-30c06bd3><!--[-->日常随笔<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/personal-website/other/" data-v-bdedfc22 data-v-95f5d58b data-v-30c06bd3><!--[-->其他<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-be450ad9 data-v-da3f667a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-da3f667a data-v-0d529b6d data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-0d529b6d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-0d529b6d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-be450ad9 data-v-f38c483a data-v-96001b6b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-96001b6b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-96001b6b><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-96001b6b><div class="VPMenu" data-v-96001b6b data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-f38c483a><div class="item appearance" data-v-f38c483a><p class="label" data-v-f38c483a>Appearance</p><div class="appearance-action" data-v-f38c483a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-f38c483a data-v-0d529b6d data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-0d529b6d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-0d529b6d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-be450ad9 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav" data-v-93a960b4 data-v-2817d72e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2817d72e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-2817d72e><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-2817d72e>Menu</span></button><a class="top-link" href="#" data-v-2817d72e>Return to top</a></div><aside class="VPSidebar" data-v-93a960b4 data-v-c79ccefa><div class="curtain" data-v-c79ccefa></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-c79ccefa><span class="visually-hidden" id="sidebar-aria-label" data-v-c79ccefa> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-c79ccefa><section class="VPSidebarItem level-0" data-v-c79ccefa data-v-b05232f3><div class="item" role="button" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link" data-v-b05232f3 data-v-30c06bd3><!--[--><h2 class="text" data-v-b05232f3>其他</h2><!--]--><!----></a><!----></div><div class="items" data-v-b05232f3><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b05232f3 data-v-b05232f3><div class="item" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link link" href="/personal-website/other/webpack.html" data-v-b05232f3 data-v-30c06bd3><!--[--><p class="text" data-v-b05232f3>webpack</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b05232f3 data-v-b05232f3><div class="item" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link link" href="/personal-website/other/git.html" data-v-b05232f3 data-v-30c06bd3><!--[--><p class="text" data-v-b05232f3>git</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b05232f3 data-v-b05232f3><div class="item" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link link" href="/personal-website/other/github-actions.html" data-v-b05232f3 data-v-30c06bd3><!--[--><p class="text" data-v-b05232f3>github-actions</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b05232f3 data-v-b05232f3><div class="item" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link link" href="/personal-website/other/YAML.html" data-v-b05232f3 data-v-30c06bd3><!--[--><p class="text" data-v-b05232f3>YAML</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-93a960b4 data-v-0bd490fb><div class="VPDoc has-sidebar has-aside" data-v-0bd490fb data-v-c5936a1e><div class="container" data-v-c5936a1e><div class="aside" data-v-c5936a1e><div class="aside-curtain" data-v-c5936a1e></div><div class="aside-container" data-v-c5936a1e><div class="aside-content" data-v-c5936a1e><div class="VPDocAside" data-v-c5936a1e data-v-cdc66372><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-cdc66372 data-v-5dd9d5f6><div class="content" data-v-5dd9d5f6><div class="outline-marker" data-v-5dd9d5f6></div><div class="outline-title" data-v-5dd9d5f6>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-5dd9d5f6><span class="visually-hidden" id="doc-outline-aria-label" data-v-5dd9d5f6> Table of Contents for current page </span><ul class="root" data-v-5dd9d5f6 data-v-1188541a><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-cdc66372></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-c5936a1e><div class="content-container" data-v-c5936a1e><!--[--><!--]--><main class="main" data-v-c5936a1e><div style="position:relative;" class="vp-doc _personal-website_other_package_json%E4%B8%AD%E7%9A%84script" data-v-c5936a1e><div><h1 id="package-json-配置" tabindex="-1">Package.json 配置 <a class="header-anchor" href="#package-json-配置" aria-hidden="true">#</a></h1><p><a href="https://docs.npmjs.com/cli/v9/using-npm/scripts" target="_blank" rel="noreferrer">官方英文文档链接</a></p><h2 id="scripts-属性" tabindex="-1">Scripts 属性 <a class="header-anchor" href="#scripts-属性" aria-hidden="true">#</a></h2><h3 id="描述" tabindex="-1">描述 <a class="header-anchor" href="#描述" aria-hidden="true">#</a></h3><p><code>package.json</code> 文件的 <code>scripts</code> 属性支持许多内置脚本以及其预设的生命周期事件和任意脚本。这些都可以通过运行 <code>npm run-script &lt;stage&gt;</code> 或者简写的 <code>npm run &lt;stage&gt;</code> 命令来执行。名称匹配的前置命令和后置命令也会运行（例如 <code>premyscript</code>, <code>myscript</code>, <code>postmyscript</code>）。来自依赖项的脚本可以通过 <code>npm explore &lt;pkg&gt; -- npm run &lt;stage&gt;</code> 来运行。</p><h3 id="pre-post-scripts" tabindex="-1">Pre &amp; Post Scripts <a class="header-anchor" href="#pre-post-scripts" aria-hidden="true">#</a></h3><p>要为 <code>package.json</code> 的 <code>scripts</code> 中定义的任何脚本创建 <code>pre</code>，<code>post</code> 脚本，只需创建另一个匹配名称的脚本，并将 <code>pre</code> 或 <code>post</code> 添加到它们的开头。</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">scripts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">precompress</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">{{ executes BEFORE the `compress` script }}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">compress</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">{{ run command to compress files }}</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">postcompress</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">{{ executes AFTER `compress` script }}</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>在这个示例中，<code>npm run compress</code> 将按照所述执行这些脚本。</p><h3 id="life-cycle-scripts-生命周期脚本" tabindex="-1">Life Cycle Scripts 生命周期脚本 <a class="header-anchor" href="#life-cycle-scripts-生命周期脚本" aria-hidden="true">#</a></h3><p>有一些特殊的生命周期脚本只发生在某些情况下。这些脚本是在 <code>pre &lt;event&gt;</code>，<code>post &lt;event&gt;</code>，<code>&lt;event&gt;</code> 脚本之外发生的。</p><p><code>prepare</code>,<code>prepublish</code>,<code>prepublishOnly</code>,<code>prepack</code>,<code>postpack</code>,<code>dependencies</code>。</p><p><strong>补充知识 - tarball</strong> npm 文档中提到的 tarball 是指一个已经压缩成 tar 格式的文件，其中包含了一个软件包的所有文件和目录。通常情况下，tarball 文件的扩展名为 .tgz 或 .tar.gz。</p><p>在 npm 中，每一个注册的软件包都有一个对应的 tarball 文件。当用户在命令行中使用 npm install 命令安装软件包时，npm 会首先下载该软件包的 tarball 文件，然后解压该文件并将其安装到本地文件系统中。</p><p>tarball 文件是 npm 包分发的标准方式之一，同时也可以在其它场景中使用，比如在不同计算机之间传递软件包或者备份软件包。</p><p><strong>prepare</strong>（npm@4.0.0 引入）</p><ul><li>在打包之前运行，即在 <code>npm publish</code> 和 <code>npm pack</code> 期间</li><li>在没有任何参数的本地 <code>npm install</code> 时运行</li><li>在 <code>republish</code> 之后，<code>prepublishOnly</code> 之前运行</li><li>注意：如果通过 git 安装的包包含一个 <code>prepare</code> 脚本，那么在打包和安装该包之前，将安装其<code>dependencies</code>和<code>devDependencies</code>,并运行其 <code>prepare</code> 脚本</li><li>从 npm@7 开始，这些脚本将在后台运行</li></ul><p><strong>prepublish</strong>（被废弃的）</p><ul><li>不在 <code>npm publish</code>期间运行，但在 <code>npm ci</code> 和 <code>npm install</code> 期间运行。更多信息见下文。</li></ul><p><strong>prepublishOnly</strong></p><ul><li>只有进行<code>npm publish</code>的时候才会执行</li></ul><p>即在打包并准备将模块发布到 registry 之前。</p><p>简单来说，<code>prepublishOnly</code> 可以用于在模块被打包之前执行一些必要的操作，例如运行单元测试、构建资源、生成文档等等，以确保最终发布的模块是可靠且高质量的。注意，该钩子只会在执行 <code>npm publish</code> 命令时触发，而不会在运行 <code>npm install</code> 时执行。</p><p>因此，如果你需要在发布模块之前进行一些操作或准备工作，你可以通过在 <code>package.json</code> 文件中定义 <code>prepublishOnly</code> 脚本来实现。</p><p><strong>prepack</strong></p><ul><li>在打包 tarball 之前运行（在 <code>npm pack</code> ，<code>npm publish</code>，或安装 git 依赖时）</li><li>注意：<code>npm run pack</code> 和 <code>npm pack</code> 不同，<code>npm run pack</code> 是一个任意用户定义的脚本名，<code>npm pack</code> 是一个 CLI 定义的命令</li></ul><p>在 npm 中，prepack 是一个钩子，它是在打包 tarball 之前执行的脚本。当使用 <code>npm pack</code> 命令打包模块时，prepack 脚本将被自动调用，此外，在使用 <code>npm publish</code> 命令发布模块以及安装git依赖项时，prepack 也会被自动调用。</p><p>prepack 可以用来执行一些需要在打包之前进行的操作，例如构建你的源代码、清除不必要的文件、运行测试等等。通过使用 prepack 脚本，你可以确保在打包 tarball 之前，你的模块已经准备就绪，并且没有遗漏的问题。</p><p>需要注意的是，<code>npm run pack</code> 和 <code>npm pack</code> 是两个不同的命令，npm run pack 是你在 package.json 中自定义的脚本命令，而 npm pack 是 npm CLI 提供的命令。因此，当你在使用 npm pack 命令打包你的模块时，prepack 脚本会被自动调用，但是当你运行 npm run pack 时，prepack 不会被自动调用，除非你在这个脚本中手动调用它。</p><p><strong>postpack</strong></p><ul><li>在 tarball 生成之后但在移动到其最终目的地之前运行（如果有的话，发布并不会在本地保存 tarball）。</li></ul><p>在使用 npm pack 命令将包打包成 tarball 后执行，但是在包被发布到 npm 注册表之前执行，即在 tarball 生成之后执行。</p><p>postpack 的目的是在包发布之前执行任何附加任务任务或自改，这可能包括修改包的元数据、运行测试或生成应包含在包中的其他文件等任务。</p><p>需要注意的是，只有在使用 npm publish 命令发布包时，postpack 脚本才会执行。如果本地安装包使用 npm install 命令，则不会执行 postpack 脚本。另外，由于 npm publish 命令不会在本地保存 tarball，因此 postpack 脚本在生成 tarball 后执行，但在 tarball 最终目的地移动之前执行（如果有的话）。</p><p><strong>dependencies</strong></p><ul><li>它会在对 node_modules 目录进行修改操作之后（如果有更改发生）运行</li><li>不会在全局模式下运行</li></ul><p>该脚本用于执行需要依赖于 node_modules 目录中安装的依赖项的任务，例如编译、构建或测试等。需要注意的是，dependencies 脚本不会在全局模式下运行，因为在全局模式下，依赖项不会被安装在 node_modules 目录中，而是安装在全局位置。此外，该脚本仅在 node_modules 目录发生更改时才会执行，如果没有更改发生，它将不会运行。</p><h4 id="prepare-and-prepublish" tabindex="-1">Prepare and Prepublish <a class="header-anchor" href="#prepare-and-prepublish" aria-hidden="true">#</a></h4><p>在 npm 4.0.0 及以上的版本中，一个新的脚本事件 prepare 被引入来代替原来的 prepublish 脚本事件。prepare 事件会在执行 npm install 和 npm publish 命令时都被触发，而 prepublish 事件则仅在 npm publish 命令执行时触发。</p><p>在 package.json 文件中，可以使用 &quot;scripts&quot; 字段来定义 prepare 和 prepublish 脚本。prepare 脚本会在执行 npm install 和 npm publish 命令之前运行，而 prepublish 脚本仅在执行 npm publish 命令之前运行。</p><p>prepare 脚本可以用于执行一些准备工作，例如构建或编译代码，或运行一些必要的测试。而 prepublish 脚本则通常用于执行一些构建和打包操作，以便为发布做好准备。</p><p>需要注意的是，从 npm 4.0.0 开始，npm 不再支持 prepublish 脚本，而是推荐使用 prepare 脚本来代替。同时，为了保持向后兼容性，npm 引入了一个新的脚本事件 prepublishOnly，用于仅在执行 npm publish 命令时运行脚本。</p><p><strong>废弃说明：prepublish</strong></p><p>自从 npm@1.1.71 版本以来，npm CLI 已经在 npm publish 和 npm install 命令中同时运行 prepublish 脚本，因为这是一种方便的方式来准备一个包供使用。但是在实践中，这种行为经常会让人感到困惑。因此，在 npm@4.0.0 版本中引入了一个新事件 prepare，以保留这种行为，同时添加了一个名为 prepublishOnly 的新事件作为过渡策略，使用户可以避免现有的 npm 版本中令人困惑的行为，并且仅在 npm publish 时运行。</p><p>请参考 <a href="https://github.com/npm/npm/issues/10074%EF%BC%8C%E4%BA%86%E8%A7%A3%E6%9B%B4%E8%AF%A6%E7%BB%86%E7%9A%84%E7%90%86%E7%94%B1%E5%92%8C%E6%9B%B4%E5%A4%9A%E9%98%85%E8%AF%BB%E6%9D%90%E6%96%99%EF%BC%8C%E4%BB%A5%E4%BA%86%E8%A7%A3%E6%AD%A4%E6%9B%B4%E6%94%B9%E7%9A%84%E8%83%8C%E6%99%AF%E3%80%82" target="_blank" rel="noreferrer">https://github.com/npm/npm/issues/10074，了解更详细的理由和更多阅读材料，以了解此更改的背景。</a></p><p><strong>示例</strong> 如果您需要在包被使用之前执行一些操作，以一种不依赖目标系统的操作系统或架构的方式，可以使用 prepublish 脚本。这些任务包括：</p><ul><li>将 CoffeeScript 源代码编译为 JavaScript。</li><li>创建 JavaScript 源代码的缩小版本。</li><li>获取您的包将使用的远程资源。</li></ul><p>在 prepublish 时执行这些操作的优点在于，它们可以在一个地方完成一次，从而降低了复杂性和变异性。此外，这意味着：</p><ul><li>您可以将 coffee-script 作为 devDependency 依赖项，从而用户不需要安装它。</li><li>您不需要在您的包中包含缩小器，为用户减少包大小。</li><li>您不需要依赖于用户在目标机器上拥有 curl 或 wget 或其他系统工具。</li></ul><h4 id="dependencies" tabindex="-1">Dependencies <a class="header-anchor" href="#dependencies" aria-hidden="true">#</a></h4><p>每当 npm 命令导致更改 node_modules目录时，都会运行 dependencies 脚本。它在应用已更改并更新 package.json 和 package-lock.json 文件之后运行。</p><h3 id="life-cycle-operation-order-生命周期操作顺序" tabindex="-1">Life Cycle Operation Order 生命周期操作顺序 <a class="header-anchor" href="#life-cycle-operation-order-生命周期操作顺序" aria-hidden="true">#</a></h3><p>npm 脚本的生命周期事件分为三类：安装、预处理、后处理。</p><p>安装事件发生在模块安装时，预处理事件发生在模块构建前，后处理事件发生在模块构建之后。</p><p><a href="https://docs.npmjs.com/cli/v9/commands/npm-cache" target="_blank" rel="noreferrer">npm cache add</a></p><ul><li>prepare</li></ul><p><a href="https://docs.npmjs.com/cli/v9/commands/npm-ci" target="_blank" rel="noreferrer">npm ci</a></p><ul><li>preinstall</li><li>install</li><li>postinstall</li><li>prepublish</li><li>preprepare</li><li>prepare</li><li>postprepare</li></ul><p>这些都是在模块安装到 node_modules 之后按顺序运行的，中间没有发生任何内部操作。</p></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-c5936a1e data-v-e033cd21><!----><div class="prev-next" data-v-e033cd21><div class="pager" data-v-e033cd21><!----></div><div class="pager" data-v-e033cd21><a class="pager-link next" href="/personal-website/other/webpack.html" data-v-e033cd21><span class="desc" data-v-e033cd21>Next page</span><span class="title" data-v-e033cd21>webpack</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"index.md\":\"b3ef4493\",\"algorithm_index.md\":\"351e708d\",\"algorithm_introduction.md\":\"0d7968c7\",\"algorithm_note.md\":\"ce144c43\",\"daily_index.md\":\"347627f3\",\"interview_company_company1.md\":\"8c76c25f\",\"other_yaml.md\":\"3fa46184\",\"other_git.md\":\"dfb7edf4\",\"other_github-actions.md\":\"a8405d8f\",\"other_index.md\":\"38b4d4af\",\"other_package.json中的script.md\":\"385b2432\",\"other_搭建静态资源服务.md\":\"2e8fbfe1\",\"other_webpack.md\":\"740c624d\",\"sourcecode_index.md\":\"f41b5d9c\",\"sourcecode_vue是如何发布的.md\":\"c06074c9\",\"vue_index.md\":\"2697b5fb\",\"vue_vue3学习笔记_note11.md\":\"57276288\",\"vue_vue3学习笔记_note3.md\":\"ec1201e9\",\"vue_vue3学习笔记_note4.md\":\"158f380a\",\"vue_vue3学习笔记_note2.md\":\"d741fa50\",\"vue_vue3学习笔记_note7.md\":\"9cb7ea5c\",\"vue_vue3学习笔记_note6.md\":\"8a0c7a35\",\"vue_vueclasscomponent.md\":\"46189d28\",\"vue_vue3学习笔记_note8.md\":\"298a5056\",\"vue_vue3学习笔记_note5.md\":\"08b69084\",\"react_index.md\":\"82dc4084\",\"javascript_js笔记.md\":\"ff1b960d\",\"javascript_proxy_reflect_装饰器.md\":\"2b305e72\",\"interview_company_company4.md\":\"50fb67a6\",\"javascript_typescript.md\":\"91707cfd\",\"interview_index.md\":\"d9d2c65f\",\"vue_vue3学习笔记_note1.md\":\"0a5f29a9\",\"vue_vue3学习笔记_note10.md\":\"fc1d9dc3\",\"javascript_index.md\":\"41a4d0da\",\"vue_vue3学习笔记_note9.md\":\"cac0a5ac\",\"interview_company_company2.md\":\"4e38f1bd\",\"interview_company_company3.md\":\"ff629a7e\",\"interview_module.md\":\"12317916\",\"javascript_js手写题.md\":\"47b4e23a\"}")</script>
    <script type="module" async src="/personal-website/assets/app.7ff22c70.js"></script>
    
  </body>
</html>